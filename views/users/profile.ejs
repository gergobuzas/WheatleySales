<% layout('/layouts/boilerplate') %>
<div>
     <div class="row">
          <h1 class="col-md-5">Profile of <%= userData.username %></h1>
          <h4 class="col-md-7 mt-2">
               <a class="link-primary" href="/profile/<%= userData._id %>/reviews"
                    style="text-decoration: none;">reviews</a>
          </h4>
     </div>


     <% if (profileProducts.length > 0) { %>
     <h4><%= userData.username %>'s listings: </h4>
     <% for (let product of profileProducts) { %>
     <div class="card">
          <div class="row">
               <div class="col-md-4">
                    <% if (product.images.length > 0) { %>
                    <img class="img-fluid" src="<%= product.images[product.images.length - 1].url %>" alt="">
                    <% } else { %>
                    <img class="img-fluid"
                         src="https://res.cloudinary.com/decc6uxs6/image/upload/v1677193348/WheatleySales/icon-image-not-found-free-vector_nypm8f.webp%>"
                         alt="Image not found">
                    <% } %>
               </div>
               <div class="col-md-8">
                    <div class="card-body">
                         <h5 class="card-title"><%= product.title %></h5>
                         <p class="card-text"> <%= product.description %></p>
                         <p class="card-text"> <small class="text-muted"> <%= product.location %> </small> </p>
                         <p class="card-text">$<%= product.price %></p>
                         <a class="btn btn-primary" href="/products/<%= product._id %> ">View</a>
                    </div>
               </div>
          </div>
     </div>
     <% } %>
     <% } else { %>
     <p class="text-muted">This user has no active listings!</p>
     <% } %>
     <% if (currentUser === userData) { %>
     <a class="btn btn-success mb-3" href="/products/new">List a product for sale!</a>
     <% } %>
</div>